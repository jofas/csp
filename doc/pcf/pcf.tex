\documentclass[journal]{IEEEtran}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage[colorlinks=true, linkcolor=black]{hyperref} % Links
\usepackage{makeidx} % Indexierung
\usepackage{siunitx}
%\usepackage[ngerman]{babel} % deutsche Sonderzeichen
\usepackage[utf8]{inputenc}
\usepackage{geometry} % Dokumentendesign wie Seiten- oder Zeilenabstand bestimmen
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{caption}
\usepackage{subcaption}
%\usepackage[toc,page]{appendix}

% Graphiken
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{pgfcore}
\usepackage{pgfopts}
\usepackage{pgfornament}
\usepackage{pgf}
\usepackage{ifthen}
\usepackage{booktabs}

% Tabellen
\usepackage{tabu}
\usepackage{longtable}
\usepackage{colortbl} % Tabellen faerben
\usepackage{multirow}
\usepackage{diagbox} % Tabellenzelle diagonal splitten

\usepackage{xcolor} % Farben
\usepackage[framemethod=tikz]{mdframed} % Hintergrunderstellung
\usepackage{enumitem} % Enumerate mit Buchstaben nummerierbar machen
\usepackage{pdfpages}
\usepackage{listings} % Source-Code darstellen
\usepackage{eurosym} % Eurosymbol
\usepackage[square,numbers]{natbib}
\usepackage{here} % figure an richtiger Stelle positionieren
\usepackage{verbatim} % Blockkommentare mit \begin{comment}...\end{comment}
\usepackage{ulem} % \sout{} (durchgestrichener Text)
\usepackage{abstract}
\usepackage{blindtext}
\usepackage{fancyref}

% BibLaTex
\bibliographystyle{acm}

% Aendern des Anhangnamens (Seite und Inhaltsverzeichnis)
%\renewcommand\appendixtocname{Anhang}
%\renewcommand\appendixpagename{Anhang}

% mdframed Style {{{
\mdfdefinestyle{codebox}{
	linewidth=2.5pt,
	linecolor=codebordercolor,
	backgroundcolor=codecolor,
	shadow=true,
	shadowcolor=black!40!white,
	fontcolor=black,
	everyline=true,
}
% }}}

% Seitenabstaende
%\geometry{left=15mm,right=15mm,top=15mm,bottom=20mm}

% TikZ Bibliotheken {{{
\usetikzlibrary{
    arrows,
    arrows.meta,
    decorations,
    backgrounds,
    positioning,
    fit,
    petri,
    shadows,
    datavisualization.formats.functions,
    calc,
    shapes,
    shapes.multipart,
    matrix
}
% }}}

\pgfplotsset{width=7cm,compat=1.15}

\definecolor{codecolor}{HTML}{EEEEEE}
\definecolor{codebordercolor}{HTML}{CCCCCC}

% Standardeinstellungen fuer Source-Code listings {{{
\lstset{
    language=C,
    breaklines=true,
    keepspaces=true,
    keywordstyle=\bfseries\color{green!70!black},
    basicstyle=\ttfamily\color{black},
    commentstyle=\itshape\color{purple},
    identifierstyle=\color{blue},
    stringstyle=\color{orange},
    showstringspaces=false,
    rulecolor=\color{black},
    tabsize=2,
    escapeinside={\%*}{*\%},
}
% }}}

%\input{libuml}
%\input{liberm}

\title{Partial Classification Forest}

\author{Jonas Fa{\ss}bender \\ [1ex]
  \href{mailto: jonas@fc-web.de}
  {jonas@fc-web.de}}
\date{}

\begin{document}

%\tableofcontents
%\newpage
%\listoffigures

\maketitle

\begin{abstract}
  %\noindent  \blindtext
\end{abstract}

\input{introduction}

\input{tree_structure/doc}

\section{Partial Classification Forest}

The PCF has two parameters, $N$ and an array with $N$
pointers. $N$ is the amount of Trees the PCF maintains.
Initially the pointers inside the array are references to
Nil nodes.

The PCF offers the same two operations a Tree has, FIT
(Algorithm~\ref{alg:pcf_fit}) and PREDICT (Algorithm~%
\ref{alg:pcf_pred}), both abstractions to the equivalent
Tree operations.

Once FIT is executed, the pointers are references to the
root of fitted Tree instances.

Both FIT and PREDICT can be implemented as multithreaded
operations as long as $\gamma$ is threadsafe, since the
Tree instances are independent of each other and the shared
parameters $X$, $y$ (FIT) and $x$ (PREDICT) are read only,
making synchronization unnecessary.

FIT first computes $\beta_X$ which has a time complexity of
$\mathcal{O}(|X[0]| * |X|)$, $|X[0]|$ denoting the amount
of dimensions the feature space has.

After that the Tree's FIT operation is called $N$ times,
which means the PCF's FIT operation has a worst case time
complexity of $\mathcal{O} (N * (2^{\tau_h + 1} - 1) *
(|X| + \mathcal{O}(\gamma)) + |X[0]| * |X|)$
(cmp.~\ref{subsec:fit}).

TODO: describe PREDICT

% {{{
\begin{algorithm}
  \caption{: FIT($\Pi, X, y, \gamma, \tau_{l},
    \tau_{|X|}, \tau_{h}$)}%
  \label{alg:pcf_fit}
  The PCF's FIT operation.

  Inputs:

    \begin{tabu}{llX}
    $\Pi$ &$-$ &a PCF instance,\\
    $X$ &$-$ &input data,\\
    $y$ &$-$ &labels of X,\\
    $\gamma$ &$-$ &function returning a predictor and its
      loss,\\
    $\tau_{l}$ &$-$ &loss threshold,\\
    $\tau_{|X|}$ &$-$ &threshold for the size of X,\\
    $\tau_{h}$ &$-$ &height limit of the Tree
    \end{tabu}

  Output: void

  \noindent\rule{\linewidth}{0.4pt}

  \begin{algorithmic}[1]
    \STATE compute $\beta_X$
    \FORALL{$\Theta \in \Pi$.trees}
      \STATE{FIT($\Theta$, $X$, $y$, 0, $\beta_X$, \dots)}
    \ENDFOR
  \end{algorithmic}
\end{algorithm}
% }}}

% {{{
\begin{algorithm}
  \caption{: PREDICT($\Pi, x$)}
  \label{alg:pcf_pred}
  The PCF's PREDICT operation.

  Inputs:

    \begin{tabu}{llX}
    $\Pi$ &$-$ &a PCF instance,\\
    $x$ &$-$ &an observation, \\
    \end{tabu}

  Output: the predicted label or \Lambda

  \noindent\rule{\linewidth}{0.4pt}

  \begin{algorithmic}[1]
    \STATE predictions $\leftarrow [\Lambda; N]$
    \FOR{$i = 1$ \TO $N$}
      \STATE{predictions$[i]$ = PREDICT($\Pi$.trees$[i]$,
        $x$, $0$)}
    \ENDFOR
    \STATE determine $l_{max}$, the label predicted most
    \RETURN $l_{max}$
  \end{algorithmic}
\end{algorithm}
% }}}

\bibliography{../csp}

%!!! https://www.kaggle.com/zynicide/wine-reviews

%Notes: - compare workflow against anomaly detection
%         (outlier removal) + classifier vs. PCF
%
%       - find real datasets for testing (3?)
%
%       - read IF and other papers describing algorithms
%
%       - read How to write a good Scientific Paper


%\section{Partial Classification Forest}

%\section{Partial Classification using PCF}

%\section{Comparison to Anomaly Detection Algorithms}

%\section{Discussion}

%\section{Conclusion}

\end{document}
